## SwapMeet - Доска объявлений

SwapMeet — это сервис доски объявлений, реализованный в микросервисной архитектуре. Он предоставляет API для работы с категориями, объявлениями и другими сущностями.


## Основные функции
* Получение списка категорий и создание новых категорий.
* Получение списка опубликованных объявлений.
* Получение опубликованного объявления по его идентификатору.
* Получение списка объявлений авторизованного пользователя.
* Создание и редактирование объявлений.
* Отправка объявления пользователем на модерацию.


## Особенности
* Сервис использует БД PpostgreSQL и кэш на базе Redis.
* В некоторых API интерфейсах сервиса используется авторизация на основе JWT(передаётся в качестве входного параметра). При этом, валидация токенов осуществляется на стороне сервиса SwapMeet(как и извлечение "пайлоада"), без выполнения запросов к сервису авторизации.  
* При запуске сервиса производится прогрев кэша(категории и опубликованные объявления)


## API
SwapMeet реализует gRPC сервис с следующими RPC вызовами:


### 1. **GetCategories**

**Описание**: Получение списка категорий. Данный вызов доступен всем категориям пользователей. При подготовке ответа используется кэш.

**Прототип**:
```
rpc GetCategories (GetCategoriesRequest) returns (GetCategoriesResponse);
```

### 2. **CreateCategory**

**Описание**: Создание новой категории. При обработке вызова к данному сервису производится проверка наличия валидного токена доступа, а также доступной роли Модератор или Администратор. Других проверок не выполняется.  

**Прототип**:
```
rpc CreateCategory (CreateCategoryRequest) returns (CreateCategoryResponse);
```

### 3. **GetPublishedAdvertisements**

**Описание**: Получение опубликованных объявлений (т.е. в статусе `published`). Данный сервис доступен как авторизованым, так и неавторизованным пользователям(т.о. передача токена доступа опциональна). Различие для авторизованных и неавторизованных пользователей будет заключаться в том, что для неавторизованных пользователей поле "ContactInfo" будет маскировано(в нём для всех объявлений будет сообщение - `"Для просмотра необходимо авторизоваться"`). 
* Вызов предусматривает возможность фильтрации по списку идентификаторов категорий.
* Если список категорий пуст, для формирования ответа на запрос используется кэш.

**Прототип**:
```
rpc GetPublishedAdvertisements (GetPublishedAdvertisementsRequest) returns (GetPublishedAdvertisementsResponse);
```

### 4. **GetUserAdvertisements**

**Описание**: Получение объявлений конкретного юзера. Вызов доступен только для авторизованных пользователей, т.е. с валидным токеном доступа(из "пайлоада" которого будет извлечен идентификатор пользователя и произведен поиск соответствующих объявлений). 

**Прототип**:
```
rpc GetUserAdvertisements (GetUserAdvertisementsRequest) returns (GetUserAdvertisementsResponse);
```

### 5. **CreateAdvertisement**

**Описание**: Создание нового объявления. Вызов доступен только для авторизованных пользователей, т.е. с валидным токеном доступа. Других проверок не выполняется. 

**Прототип**:
```
rpc CreateAdvertisement (CreateAdvertisementRequest) returns (CreateAdvertisementResponse);
```

### 6. **UpdateAdvertisement**

**Описание**: Изменение существующего объявления. Вызов доступен только для авторизованных пользователей, т.е. с валидным токеном доступа. Других проверок, за исключением поиска объявления по переданному идентификатору и идентификатору пользователя(извлеченному из "пайлоада") не выполняется. 

**Прототип**:
```
rpc UpdateAdvertisement (UpdateAdvertisementRequest) returns (UpdateAdvertisementResponse);
```


### 7. **GetAdvertisementByID**

**Описание**: Поиск объявления по ID. Вызов доступен и авторизованным и неавторизованным пользователям. Передача токена доступа не требуется.

**Прототип**:
```
rpc GetAdvertisementByID (GetAdvertisementByIDRequest) returns (GetAdvertisementByIDResponse);
```

### 8. **SubmitAdvertisementForModeration**

**Описание**: Отправка объявления на модерацию. Вызов доступен только для авторизованных пользователей, т.е. с валидным токеном доступа. Других проверок, за исключением поиска объявления по переданному идентификатору и идентификатору пользователя(извлеченному из "пайлоада") не выполняется. 

**Прототип**:
```
rpc SubmitAdvertisementForModeration (SubmitAdvertisementForModerationRequest) returns (SubmitAdvertisementForModerationResponse);
```
